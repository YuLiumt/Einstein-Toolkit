<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Yu Liu">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>MHD - Yu Liu's Notebook</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "MHD";
    var mkdocs_page_input_path = "NR/MHD.md";
    var mkdocs_page_url = "/Einstein-Toolkit/NR/MHD/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-36723568-3', 'https://yuliumt.github.io');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Yu Liu's Notebook</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Einstein Toolkit</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../ET/Introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ET/Install/">Install</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ET/Cactus/">Cactus</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ET/Thorn/">Thorn</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ET/Source File/">Source File</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ET/parameter/">Parameter</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ET/Lorene/">Lorene</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ET/Visualization/">Visualization</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">General Relativity</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../GR/Differential geometry/">Differential geometry</a>
                </li>
                <li class="">
                    
    <a class="" href="../../GR/Einstein Equation/">Einstein Equation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../GR/Solutions/">Solutions</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Gravitational Wave</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../GW/Introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../GW/Linearized Waves/">Linearized Waves</a>
                </li>
                <li class="">
                    
    <a class="" href="../../GW/Extracting Gravitational Waveforms/">Extracting Gravitational Waveforms</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Numerical Relativity</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../3+1 Decomposition/">3+1 Decomposition</a>
                </li>
                <li class="">
                    
    <a class="" href="../ADM/">ADM</a>
                </li>
                <li class="">
                    
    <a class="" href="../BSSN/">BSSN</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">MHD</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#grmhd">GRMHD</a></li>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../Conformal Transformation/">Conformal Transformation</a>
                </li>
                <li class="">
                    
    <a class="" href="../Coordinates/">Coordinates</a>
                </li>
                <li class="">
                    
    <a class="" href="../Matter Sources/">Matter Sources</a>
                </li>
                <li class="">
                    
    <a class="" href="../Numerical Methods/">Numerical Methods</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Search Pipeline</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../SP/Introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../SP/matched filter/">Matched Filtering</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Example</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../Example/Poisson/">Poisson</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Yu Liu's Notebook</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Numerical Relativity &raquo;</li>
        
      
    
    <li>MHD</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/YuLiumt/Einstein-Toolkit/edit/master/docs/NR/MHD.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>The GRHydro scheme is written in a first-order hyperbolic flux-conservative evolution system for the conserved variables D, <span><span class="MathJax_Preview">S^{i}</span><script type="math/tex">S^{i}</script></span>, <span><span class="MathJax_Preview">\tau</span><script type="math/tex">\tau</script></span>, and <span><span class="MathJax_Preview">\mathcal{B}^{i}</span><script type="math/tex">\mathcal{B}^{i}</script></span>, defined in terms of the primitive variables <span><span class="MathJax_Preview">\rho</span><script type="math/tex">\rho</script></span>, <span><span class="MathJax_Preview">\epsilon</span><script type="math/tex">\epsilon</script></span>, <span><span class="MathJax_Preview">v^{i}</span><script type="math/tex">v^{i}</script></span>, and <span><span class="MathJax_Preview">B^{i}</span><script type="math/tex">B^{i}</script></span> such that</p>
<div>
<div class="MathJax_Preview">
\begin{aligned} D &amp;=\sqrt{\gamma} \rho W \\ S_{j} &amp;=\sqrt{\gamma}\left(\rho h^{*} W^{2} v_{j}-\alpha b^{0} b_{j}\right) \\ \tau &amp;=\sqrt{\gamma}\left(\rho h^{*} W^{2}-P^{*}-\left(\alpha b^{0}\right)^{2}\right)-D \\ \mathcal{B}^{k} &amp;=\sqrt{\gamma} B^{k} \end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned} D &=\sqrt{\gamma} \rho W \\ S_{j} &=\sqrt{\gamma}\left(\rho h^{*} W^{2} v_{j}-\alpha b^{0} b_{j}\right) \\ \tau &=\sqrt{\gamma}\left(\rho h^{*} W^{2}-P^{*}-\left(\alpha b^{0}\right)^{2}\right)-D \\ \mathcal{B}^{k} &=\sqrt{\gamma} B^{k} \end{aligned}
</script>
</div>
<p>where <span><span class="MathJax_Preview">\gamma</span><script type="math/tex">\gamma</script></span> is the determinant of <span><span class="MathJax_Preview">\gamma_{i j}</span><script type="math/tex">\gamma_{i j}</script></span>. We choose a definition of the 3-velocity <span><span class="MathJax_Preview">v^{i}</span><script type="math/tex">v^{i}</script></span> that corresponds to the velocity seen by an Eulerian observer at rest in the current spatial 3-hypersurface </p>
<div>
<div class="MathJax_Preview">
v^{i}=\frac{u^{i}}{W}+\frac{\beta^{i}}{\alpha}
</div>
<script type="math/tex; mode=display">
v^{i}=\frac{u^{i}}{W}+\frac{\beta^{i}}{\alpha}
</script>
</div>
<p>and <span><span class="MathJax_Preview">W \equiv\left(1-v^{i} v_{i}\right)^{-1 / 2}</span><script type="math/tex">W \equiv\left(1-v^{i} v_{i}\right)^{-1 / 2}</script></span> is the Lorentz factor. Note that <span><span class="MathJax_Preview">v^{i}</span><script type="math/tex">v^{i}</script></span>, <span><span class="MathJax_Preview">B^{i}</span><script type="math/tex">B^{i}</script></span>, <span><span class="MathJax_Preview">S^{i}</span><script type="math/tex">S^{i}</script></span>, and <span><span class="MathJax_Preview">\beta^{i}</span><script type="math/tex">\beta^{i}</script></span> are 3-vectors, and their indices are raised and lowered with the 3-metric, e.g., <span><span class="MathJax_Preview">v_{i} \equiv \gamma_{i j} v^{j}</span><script type="math/tex">v_{i} \equiv \gamma_{i j} v^{j}</script></span>.</p>
<p>The evolution system for the conserved variables,</p>
<div>
<div class="MathJax_Preview">
\frac{\partial \mathbf{U}}{\partial t}+\frac{\partial \mathbf{F}^{i}}{\partial x^{i}}=\mathbf{S}
</div>
<script type="math/tex; mode=display">
\frac{\partial \mathbf{U}}{\partial t}+\frac{\partial \mathbf{F}^{i}}{\partial x^{i}}=\mathbf{S}
</script>
</div>
<p>with </p>
<div>
<div class="MathJax_Preview">
\mathbf{U}=\left[D, S_{j}, \tau, \mathcal{B}^{k}\right] \\
\mathbf{F}^{i}=\alpha \times \left[ \begin{array}{c}{D \tilde{v}^{i}} \\ {S_{j} \tilde{v}^{i}+\sqrt{\gamma} P^{*} \delta_{j}^{i}-b_{j} \mathcal{B}^{i} / W} \\ {\tau \tilde{v}^{i}+\sqrt{\gamma} P^{*} v^{i}-\alpha b^{0} \mathcal{B}^{i} / W} \\ {\mathcal{B}^{k} \tilde{v}^{i}-\mathcal{B}^{i} \tilde{v}^{k}}\end{array}\right] \\
\mathbf{S}=\alpha \sqrt{\gamma} \times \left[ \begin{array}{c}{0} \\ {T^{\mu \nu}\left(\frac{\partial g_{i}-\Gamma_{\mu}^{\lambda} g_{\lambda j} )}{\partial x^{\mu}}-\Gamma_{\mu}^{\lambda} g_{\lambda j}\right)} \\ {\alpha\left(T^{\mu 0 \ln \alpha}-T^{\mu \nu} \Gamma_{\mu \nu}^{0}\right)} \\ {\overline{0}}\end{array}\right]
</div>
<script type="math/tex; mode=display">
\mathbf{U}=\left[D, S_{j}, \tau, \mathcal{B}^{k}\right] \\
\mathbf{F}^{i}=\alpha \times \left[ \begin{array}{c}{D \tilde{v}^{i}} \\ {S_{j} \tilde{v}^{i}+\sqrt{\gamma} P^{*} \delta_{j}^{i}-b_{j} \mathcal{B}^{i} / W} \\ {\tau \tilde{v}^{i}+\sqrt{\gamma} P^{*} v^{i}-\alpha b^{0} \mathcal{B}^{i} / W} \\ {\mathcal{B}^{k} \tilde{v}^{i}-\mathcal{B}^{i} \tilde{v}^{k}}\end{array}\right] \\
\mathbf{S}=\alpha \sqrt{\gamma} \times \left[ \begin{array}{c}{0} \\ {T^{\mu \nu}\left(\frac{\partial g_{i}-\Gamma_{\mu}^{\lambda} g_{\lambda j} )}{\partial x^{\mu}}-\Gamma_{\mu}^{\lambda} g_{\lambda j}\right)} \\ {\alpha\left(T^{\mu 0 \ln \alpha}-T^{\mu \nu} \Gamma_{\mu \nu}^{0}\right)} \\ {\overline{0}}\end{array}\right]
</script>
</div>
<p>Here, <span><span class="MathJax_Preview">\tilde{v}^{i}=v^{i}-\beta^{i} / \alpha</span><script type="math/tex">\tilde{v}^{i}=v^{i}-\beta^{i} / \alpha</script></span> and <span><span class="MathJax_Preview">\Gamma_{\mu \nu}^{\lambda}</span><script type="math/tex">\Gamma_{\mu \nu}^{\lambda}</script></span> are the 4-Christoffel symbols.</p>
<p>The magnetic field is divergence-free, the “no-monopoles” constraint:</p>
<div>
<div class="MathJax_Preview">
\nabla \cdot B \equiv \frac{1}{\sqrt{\gamma}} \partial_{i}\left(\sqrt{\gamma} B^{i}\right)=0
</div>
<script type="math/tex; mode=display">
\nabla \cdot B \equiv \frac{1}{\sqrt{\gamma}} \partial_{i}\left(\sqrt{\gamma} B^{i}\right)=0
</script>
</div>
<p>which also implies</p>
<div>
<div class="MathJax_Preview">
\partial_{i} \mathcal{B}^{i}=0
</div>
<script type="math/tex; mode=display">
\partial_{i} \mathcal{B}^{i}=0
</script>
</div>
<p>In practice, <strong>we implement two different methods to actively enforce this constraint</strong>. In the “divergence cleaning” technique we include the ability to modify the magnetic field evolution by introducing a new field variable that dissipates away numerical divergences. An alternative method, commonly called “constrained transport”, instead carefully constructs a numerical method so that the constraint is satisfied to round-off error at the discrete level.</p>
<p><strong>Reconstruction</strong></p>
<hr />
<p>The GRHydro code now includes several improved higher-order techniques for <strong>reconstruction of states at cell interfaces for use in high-resolution shock capturing</strong>.</p>
<p>In a finite-volume scheme, <strong>one evaluates fluxes at cell faces by solving Riemann problems involving potentially discontinuous hydrodynamic states on either side of the interface</strong>. To construct these Riemann problems, one must first obtain the fluid state on the left and right sides of the interface. The fluid state is known within cells in the form of cell-averages of the hydrodynamical variables. The reconstruction step interpolates the fluid state from cell averaged values to values at cell interfaces without introducing oscillations at shocks and other discontinuities. It is possible to reconstruct either primitive or conserved fluid variables, however using the former makes it much easier to guarantee physically valid results for which the pressure is positive and the fluid velocities sub-luminal.</p>
<p>By assuming an orthogonal set of coordinates, it is possible to reconstruct each coordinate direction independently. Thus, the fluid reconstruction reduces to a one-dimensional problem.</p>
<p><strong>Primitive variable transformations</strong></p>
<hr />
<p>In GRHD, converting the conservative variables back to the primitives is a relatively straightforward task. GRHydro accomplishes the task through a 1D Newton-Raphson scheme. The scheme iterates by estimating the fluid pressure, determining the density, internal energy and the conservative quantities given this estimate, and using those in turn to calculate a new value for the pressure and its residual. The method works for any EOS, so long as one can calculate the thermodynamic derivatives <span><span class="MathJax_Preview">\mathrm{d} P / \mathrm{d}\left.\rho\right|_{\epsilon}</span><script type="math/tex">\mathrm{d} P / \mathrm{d}\left.\rho\right|_{\epsilon}</script></span> and <span><span class="MathJax_Preview">\mathrm{d} P / \mathrm{d}\left.\epsilon\right|_{\rho}</span><script type="math/tex">\mathrm{d} P / \mathrm{d}\left.\epsilon\right|_{\rho}</script></span>.</p>
<p><strong>Equation of State</strong></p>
<hr />
<p>We implement the conversion of conserved to primitive variables for arbitrary equations of state (EOS), including polytropic, Γ-law, hybrid polytropic/Γ-law, and microphysical finite-temperature EOS.</p>
<p>The Einstein Toolkit EOS interface uses the pressure as a function of density and the specific internal energy <span><span class="MathJax_Preview">\epsilon</span><script type="math/tex">\epsilon</script></span>, <span><span class="MathJax_Preview">P=P(\rho, \epsilon)</span><script type="math/tex">P=P(\rho, \epsilon)</script></span>, and calculates partial derivatives against those variables, rather than <span><span class="MathJax_Preview">\rho</span><script type="math/tex">\rho</script></span> and <span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>.</p>
<h3 id="grmhd">GRMHD</h3>
<p>The MHD code stores the values of both the primitive B-field vector, <span><span class="MathJax_Preview">B^{i}</span><script type="math/tex">B^{i}</script></span> (<code class="codehilite">Bvec</code> in the code), and the evolved conservative field <span><span class="MathJax_Preview">B^{i}</span><script type="math/tex">B^{i}</script></span> (<code class="codehilite">Bcons</code> in the code) in the frame of the Eulerian observers. For analysis purposes we include options to compute the magnetic field in fluid’s rest frame</p>
<div>
<div class="MathJax_Preview">
\begin{aligned} b^{0} &amp;=\frac{W B^{k} v_{k}}{\alpha} \\ b^{i} &amp;=\frac{B^{i}}{W}+W\left(B^{k} v_{k}\right)\left(v^{i}-\frac{\beta^{i}}{\alpha}\right) \\ b^{2} &amp;=\frac{B^{i} B_{i}}{W^{2}}+\left(B^{i} v_{i}\right)^{2} \end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned} b^{0} &=\frac{W B^{k} v_{k}}{\alpha} \\ b^{i} &=\frac{B^{i}}{W}+W\left(B^{k} v_{k}\right)\left(v^{i}-\frac{\beta^{i}}{\alpha}\right) \\ b^{2} &=\frac{B^{i} B_{i}}{W^{2}}+\left(B^{i} v_{i}\right)^{2} \end{aligned}
</script>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Conformal Transformation/" class="btn btn-neutral float-right" title="Conformal Transformation">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../BSSN/" class="btn btn-neutral" title="BSSN"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/YuLiumt/Einstein-Toolkit/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../BSSN/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Conformal Transformation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
